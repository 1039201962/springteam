   <div class="main">
      <div class="container">
        <!-- BEGIN SIDEBAR & CONTENT -->
        <div class="row margin-bottom-40">
          <!-- BEGIN CONTENT -->
          <div class="col-md-12 col-sm-12">
            <h1>购物车</h1>
            <div class="goods-page">
              <div class="goods-data clearfix">
                <div class="table-wrapper-responsive">
                <table class="table table-hover">
					<thead>
						<tr>
						    <th><input type="checkbox" id="checkAll">全选</th>
							<th class="goods-page-image">商品图片</th>
                            <th class="goods-page-description">商品描述</th>
                            <th class="goods-page-quantity">数量</th>
                            <th class="goods-page-price">单价</th>
                            <th class="goods-page-total" colspan="2">总价</th>
						</tr>
					</thead>
					<tbody id="tbodyId">
					    <tr>
					       <td colspan="7">数据正在加载中...</td>
					    </tr>
					</tbody>
				</table>
                </div>
                <div id="pageId" class="box-footer clearfix">
			      
			    </div>
			
                <div class="shopping-total">
                  <ul>
                    <li>
                      <em>商品总额</em>
                      <strong class="price"><span>$</span>47.00</strong>
                    </li>
                    <li>
                      <em>运费</em>
                      <strong class="price"><span>$</span>3.00</strong>
                    </li>
                    <li class="shopping-total-price">
                      <em>总支付</em>
                      <strong class="price"><span>$</span>50.00</strong>
                    </li>
                  </ul>
                </div>
              </div>
              <button id="butshop" class="btn btn-default" type="submit">继续购物<i class="fa fa-shopping-cart"></i></button>
              <button id="butout" class="btn btn-primary" type="submit">结算<i class="fa fa-check"></i></button>
            </div>
          </div>
          <!-- END CONTENT -->
        </div>
      </div>
    </div>   
 <script type="text/javascript">
    jQuery(document).ready(function() {
        Layout.init();    
        Layout.initOWL();
        //Layout.initTwitter();
        Layout.initImageZoom();
        Layout.initTouchspin();
    });
    
    $(function(){ 	  
  	  //跳转到首页
  	  $("#butshop").click(function(){
  		  $("#content").load("/index");
  	  })
  	  //结算点击事件
  	  $("#butout").click(function(){
  		  //取数据
  		  var goodsIds = $("#butout").data("goodsIds");
  			$.ajax({
  				url:"/orders/doAddOrder",
  				method:"get",
  				//anysc:false,
  				data:{
  					"goodsIds":goodsIds
  				}
  				success:function(result){
  					if(result == 1)
  						console.log("提交成功");
  					$("#content").load("/shop-wishlist");
  				}else{
  					console.log("提交异常")；
  				}
  				
  			})
  	  });
  	 
  	  //页面加载完成异步加载doFindPageObjects对应的资源
      $("#pageId").load("doFindPageObjects",doGetObjects);
      
     //全选按钮事件注册
	  $("#checkAll").change(doChangeTBodyCheckBoxState);
	  //基于tbody中checkbox状态,修改thead中checkbox状态
	  $("#tbodyId").on("change",".cBox",doChangeTHeadCheckBoxState)
	  //删除按钮事件注册
	  $("#tbodyId").on("click",".btn-delete",doDeleteObjects)
    });  
  	  
  //点击删除按钮时执行删除操作
      function doDeleteObjects(){
 	   //1.获取选中记录对象的checkbox的值并进行判定
 	   var idArray=doGetCheckedIds();
 	   //console.log(idArray.toString());//123456
 	   if(idArray.length==0){
 		   alert("请先选中");
 		   return;
 	   }
 	   if(!confirm("确认删除吗?"))return;
 	   //2.构建请求参数
 	   var params={"ids":idArray.toString()}
 	   //3.构建请求url
 	   var url="/doDeleteCar"
 	   //4.发送异步请求执行删除操作.
 	   $.post(url,params,function(result){
 		   if(result.state==1){
 			   alert(result.message);
 			   //查询刷新
 			   doSetPageCurrent();
 			   doGetObjects();
 		   }else{
 			   alert(result.message);
 		   }
 	   })
    }
  
      function doGetCheckedIds(){
    		 //1.定义数组
    		 var idArray=[];
    		 //2.迭代所有tbody中的checkbox,将选中的值存储到数组
    		 $("#tbodyId input[type='checkbox']")
    		 //each函数用于迭代元素,每发现一个就会执行function(){}
    		 .each(function(){
    			 //$(this)代表发现的checkbox对象
    			 //记住所有checkbox默认都有一个checked属性
    			 if($(this).prop("checked")){//选中状态
    				 idArray.push($(this).val());
    			 }
    		 })
    		 //3.返回存储了id的数组
    		 return idArray;
    	   }
    
  //删除以后刷新
    function doSetPageCurrent(){
   	 var pageCount=$("#pageId").data("pageCount");
   	 var pageCurrent=$("#pageId").data("pageCurrent");
   	 var checked=$("#checkAll").prop("checked");
   	 if(pageCurrent==pageCount&&checked&&pageCurrent>1){
   		 pageCurrent--;
   		 $("#pageId").data("pageCurrent",pageCurrent);
   	 }
   }
    
     //基于tbody中checkbox状态,修改thead中checkbox状态
     function doChangeTHeadCheckBoxState(){
 	  //1.获取tbody中checbox对象状态相与的结果
 	  var flag=true;
 	  $("#tbodyId input[type='checkbox']")
 	  .each(function(){
 		  flag=flag&&$(this).prop("checked");
 	  });
 	  //2.修改thead中checkbox的值
 	  $("#checkAll").prop("checked",flag);
    }
   
     //点击thead中checkbox时,修改tbody中checkbox的状态
     function doChangeTBodyCheckBoxState(){
  	   //1.获取点击对象的状态
  	   var flag=$(this).prop("checked");
  	   //2.修改tbody中checkbox的状态
  	   $("#tbodyId input[type='checkbox']")
  	   .each(function(){
  		   //prop方法中两个参数时表示为属性赋值
  		   $(this).prop("checked",flag);
  	   });
     }
     
  	  //异步(底层启动工作线程)加载服务端数据
      function doGetObjects(){
   	  $("#checkAll").prop("checked",false);
   	  //debugger
   	  //1.定义请求参数
   	  var pageCurrent=$("#pageId").data("pageCurrent");
   	  if(!pageCurrent)pageCurrent=1;
   	  var params={"pageCurrent":pageCurrent};
   	  var uname=$("#searchNameId").val();
   	  if(uname)params.username=uname;
   	  //2.定义请求的url
   	  var url="log/doFindPageObjects";
   	  //3.发送异步请求加载日志数据
   	  //1)getJSON为Jquery框架中的函数
   	  //2)getJson用于向服务端发起Get请求
   	  //3)getJSON会将服务端返回的JSON串直接转换为JSON格式的JS对象
   	  //4)function(result){}会在服务端数据响应到客户端以后执行
   	  $.getJSON(url,params,function(result){//jsonResult
   		  console.log("result",result)
   		  //处理查询结果
   		  doHandleResponseResult(result);
   	  });
      }
    
  	  //处理购物车查询结果
      function doHandleResponseResult(result){
   	      if(result.state==1){
   	    	  //1.呈现查询的购物车记录
   	    	  //console.log(result.data.records)
   	    	  doSetTableBodyRows(result.data.records.carGoods);
   	    	  //2.呈现分页信息
   	    	  doSetPagination(result.data);//pageObject
   	      }else{
   	    	  alert(result.message);
   	      }
      }
     
  	  //追加购物车记录到tbody中
      function doSetTableBodyRows(carGoods){
   	   //1.获取tbody对象,并清空内容
   	   var tBody=$("#tbodyId");
   	   tBody.empty();
   	   //声明数组
   	   var goodsIds = [];
   	   //2.将记录添加到tbody中
   	   for(var i=0;i<carGoods.length;i++){
   		   //储存id到数组
   		   goodsIds[i] = carGoods.goodsId;
   		  //2.1创建tr对象
   		  var tr=$("<tr></tr>");
   		  //2.2创建多个td对象
   		  var tds=doCreateTds(carGoods[i]);
   		  //2.3将td追加到tr中
   		  tr.append(tds);
   		  //2.4将tr追加到tbody中
   		  tBody.append(tr);
   	   }
   	   //储存到dom上
   		$("#butout").data("goodsIds",goodsIds);
      }
      
  	  function doCreateTds(data){
  	    var tds="<td><input type='checkbox' class='cBox' name='cItem' value='"+data.userId+"'></td>"+
  		   	 "<td>"+data.main_img+"</td>"+
  		     "<td>"+data.descript+"</td>"+
  		     "<td><input id='product-quantity' type='text' value='"+data.num+"' class='form-control input-sm'></td>"+
  		     "<td>"+data.price+"</td>"+
  		     "<td>"+data.total+"</td>"+
  		     "<td><button type='button' class='btn btn-default btn-delete' value='"+data.userId+"'>删除</button></td>";	     
           return tds;
     }
    </script>
 